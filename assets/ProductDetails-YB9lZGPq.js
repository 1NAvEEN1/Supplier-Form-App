import{r as h,j as e}from"./react-G0VBmWxS.js";import{u as Z,a as $}from"./react-redux-3PpUptFA.js";import{a as S,d as ee,e as se,f as V,g as D}from"./index-pJPwAMK0.js";import{a as te}from"./axios-zw96FDk0.js";import{u as re,T as ne}from"./react-i18next-Ld4qvRaQ.js";import{B as v,G as s,T as n,D as q,R as _,j as z,k as T,i as E,A as H,m as P,n as ae,o as J,b as I,u as L,I as Y,p as ie,q as oe,t as le,v as K,w as X,x as ce}from"./@mui-lgJpmoNL.js";import"./@babel-SkaEL2tl.js";import"./use-sync-external-store-BBrSSgse.js";import"./react-dom-wkoTY-Le.js";import"./scheduler-iwWdm5Ml.js";import"./react-router-dom-8rnrgVg8.js";import"./react-router-mRKdHBLr.js";import"./@remix-run-EOO7uaRF.js";import"./@reduxjs-OWLxucYK.js";import"./redux-vWdE9iQ8.js";import"./immer-2VFgZgpn.js";import"./reselect-knrTZChY.js";import"./redux-thunk-qyK_zz9Y.js";import"./prop-types-nTg9hSou.js";import"./i18next-NCffezqA.js";import"./i18next-http-backend-6HvsPMKJ.js";import"./cross-fetch-xd-Enngl.js";import"./clsx-2Jv0kmJG.js";import"./react-transition-group-NM3J4weW.js";import"./@emotion-cuKUoGzU.js";import"./hoist-non-react-statics-MGeNrgoW.js";import"./react-is-cHOZVpRJ.js";import"./stylis-UTZzoVRx.js";import"./@popperjs-zyV4rJhQ.js";import"./html-parse-stringify-gNhRsLCw.js";import"./void-elements-KNW2nDh4.js";const de=async()=>{const d="/Product/GetProductCategories";return te.get(`https://supplierapi.cehub.lk/api${d}`).catch(l=>{console.log(l)})},ue=async d=>{const l=`/Product/GetProductSubCategories/${d}`;return te.get(`https://supplierapi.cehub.lk/api${l}`).catch(i=>{console.log(i)})},A="1px 5px 8px 5px rgba(0, 0, 0, 0.05)",M="-1px 1px 8px 5px rgba(255, 0, 0, 0.3)",F=({children:d,sx:l={},...i})=>e.jsx(v,{sx:{borderRadius:3,mt:3,pt:1,pr:0,pb:1,...l},...i,children:d}),he=({closeDrawer:d})=>{const l=Z(),{t:i,i18n:y}=re(),W=$(t=>t.form.formData),w=$(t=>t.form.productCategoryNames),j={productOrRaw:!0,category:0,subCategory:0,name:"",pricing:{price:"",priceQtyUnitValue:"",priceQtyUnit:10},supplyQty:"",orderQty:"",supplyFrequency:!0,selectedMonths:[],otherDetails:""},[r,f]=h.useState(j),[x,m]=h.useState(""),[b,C]=h.useState([]),[O,N]=h.useState([]),Q=async()=>{try{const t=await de();C(t.data)}catch(t){console.error("Error fetching Categories:",t)}};h.useEffect(()=>{Q()},[]);const k=async()=>{try{const t=await ue(r.category);N(t.data)}catch(t){console.error("Error fetching Cities:",t)}};h.useEffect(()=>{!r.category==0&&k()},[r.category]),h.useEffect(()=>{var a;const t=S.getState().form.selectedProductIndex;t!==99&&f((a=S.getState().form.formData)==null?void 0:a.productDetails[t])},[S.getState().form.selectedProductIndex]);const u=(t,a,p=null)=>{m(""),f(p?g=>({...g,[t]:{...g[t],[p]:a}}):g=>({...g,[t]:a,...t==="category"&&{subCategory:0}}))},U=t=>{const p=r.selectedMonths.includes(t)?r.selectedMonths.filter(g=>g!==t):[...r.selectedMonths,t];u("selectedMonths",p)},B=()=>{const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return e.jsx(s,{container:!0,spacing:2,children:t.map((a,p)=>e.jsx(s,{item:!0,xs:3,display:"flex",justifyContent:"center",children:e.jsx(v,{bgcolor:r.selectedMonths.includes(a)?"#F47621":"#D5D8DC",onClick:()=>U(a),sx:{borderRadius:2,width:60,height:40,"&:hover":{cursor:"pointer",border:"2px solid #F47621"}},display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(n,{textAlign:"center",children:a})})},p))})},R=()=>{if(r.productOrRaw){if(r.category==0)return D({message:"Please select a product category !",type:"error"}),m("category"),0;if(r.subCategory==0)return D({message:"Please select a product subcategory !",type:"error"}),m("subCategory"),0}return r.name==""?(D({message:"Please enter the product name !",type:"error"}),m("name"),0):r.pricing.price==""?(D({message:"Please enter the product price !",type:"error"}),m("price"),0):r.pricing.priceQtyUnitValue==""?(D({message:"Please enter the price unit quantity!",type:"error"}),m("unit"),0):r.supplyQty==""?(D({message:"Please enter the monthly supply quantity !",type:"error"}),m("supplyQty"),0):!r.supplyFrequency&&r.selectedMonths.length==0?(D({message:"Please select the month range !",type:"error"}),0):1},o=()=>{if(console.log(r),R()){const a=[...W.productDetails],p=[...w],g={category:b.find(G=>G.id===r.category),subCategory:O.find(G=>G.id===r.subCategory)};S.getState().form.selectedProductIndex!==99?(a[S.getState().form.selectedProductIndex]=r,p[S.getState().form.selectedProductIndex]=g):(a.push(r),p.push(g)),l(ee(a)),l(se(p)),f(j),l(V(99)),d()}},c=()=>{f(j),l(V(99)),d()};return e.jsx(v,{sx:{display:"flex",justifyContent:"center",bgcolor:"#F9FAFB"},children:e.jsxs(s,{container:!0,sx:{minHeight:"90svh",p:2,width:500,borderRadius:4},children:[e.jsxs(s,{item:!0,xs:12,children:[e.jsx(n,{textAlign:"center",fontWeight:600,mb:2,children:i("translation:AddProduct:heading")}),e.jsx(q,{style:{width:"100%",marginBottom:25}}),e.jsx(_,{"aria-labelledby":"demo-radio-buttons-group-label",value:r.productOrRaw.toString(),onChange:t=>u("productOrRaw",t.target.value==="true"),name:"radio-buttons-group",children:e.jsxs(s,{container:!0,children:[e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{variant:"h5",children:i("translation:AddProduct:product")})}),e.jsx(s,{item:!0,xs:6,display:"flex",justifyContent:"end",mb:2,children:e.jsx(z,{value:"true",control:e.jsx(T,{}),labelPlacement:"start"})}),e.jsx(s,{item:!0,xs:6,children:e.jsx(n,{variant:"h5",children:i("translation:AddProduct:rawMaterial")})}),e.jsx(s,{item:!0,xs:6,display:"flex",justifyContent:"end",mb:2,children:e.jsx(z,{value:"false",control:e.jsx(T,{}),labelPlacement:"start"})})]})}),r.productOrRaw&&e.jsxs(e.Fragment,{children:[" ",e.jsxs(F,{sx:{boxShadow:x==="category"?M:A},children:[e.jsx(n,{variant:"b1",fontWeight:500,color:"primary",pl:2,children:i("translation:AddProduct:category")}),e.jsx(E,{fullWidth:!0,children:e.jsx(H,{value:b.find(t=>t.id===r.category)||null,size:"small",options:b,getOptionLabel:t=>y.language==="en"?t.nameEnglish:y.language==="si"?t.nameSinhala:t.nameTamil,onChange:(t,a)=>{u("category",a?a.id:0)},renderInput:t=>e.jsx(P,{...t,placeholder:i("translation:AddProduct:selectCategory"),sx:{".MuiOutlinedInput-notchedOutline":{border:0},borderRadius:3,height:40}})})})]}),e.jsxs(F,{sx:{boxShadow:x==="subCategory"?M:A},children:[e.jsx(n,{variant:"b1",fontWeight:500,color:"primary",pl:2,children:i("translation:AddProduct:subCategory")}),e.jsx(E,{fullWidth:!0,children:e.jsx(H,{value:O.find(t=>t.id===r.subCategory)||null,size:"small",options:O,getOptionLabel:t=>y.language==="en"?t.nameEnglish:y.language==="si"?t.nameSinhala:t.nameTamil,onChange:(t,a)=>{u("subCategory",a?a.id:0)},renderInput:t=>e.jsx(P,{...t,placeholder:i("translation:AddProduct:selectSubCategory"),sx:{".MuiOutlinedInput-notchedOutline":{border:0},borderRadius:3,height:40}}),disabled:r.category===0})})]})]}),e.jsxs(F,{sx:{boxShadow:x==="name"?M:A},children:[e.jsx(n,{color:"primary",pl:2,children:i("translation:AddProduct:name")}),e.jsx(P,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0}},placeholder:i("translation:AddProduct:productName"),fullWidth:!0,value:r.name,onChange:t=>u("name",t.target.value)})]})]}),e.jsxs(s,{item:!0,xs:12,mt:3,children:[e.jsx(n,{fontWeight:600,children:i("translation:AddProduct:pricing")}),e.jsx(n,{fontSize:"13px",mt:1,children:e.jsxs(ne,{i18nKey:"AddProduct.text1",children:["Please select the units of quantity when adding price. ",e.jsx("br",{}),"(For example: per kg, per liter, per gram, per one piece, etc.)"]})}),e.jsxs(s,{container:!0,spacing:2,children:[e.jsx(s,{item:!0,xs:6,children:e.jsxs(F,{sx:{boxShadow:x==="price"?M:A},children:[e.jsx(n,{color:"primary",pl:2,children:"Price (Rupees)"}),e.jsx(P,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0}},placeholder:"0000",fullWidth:!0,type:"number",inputProps:{style:{fontWeight:"bold"}},value:r.pricing.price,onChange:t=>{const a=Math.max(0,t.target.value);u("pricing",a,"price")}})]})}),e.jsx(s,{item:!0,xs:6,children:e.jsxs(F,{height:85,sx:{boxShadow:x==="unit"?M:A},children:[e.jsx(n,{color:"primary",pl:2,mb:1,children:"Quantity unit"}),e.jsxs(s,{container:!0,children:[e.jsx(s,{item:!0,xs:5,mb:3,children:e.jsx(P,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0}},placeholder:"00",fullWidth:!0,type:"number",inputProps:{style:{fontWeight:"bold"}},value:r.pricing.priceQtyUnitValue,onChange:t=>{const a=Math.max(0,t.target.value);u("pricing",a,"priceQtyUnitValue")}})}),e.jsx(s,{item:!0,xs:7,mt:.5,children:e.jsx(E,{fullWidth:!0,children:e.jsxs(ae,{id:"demo-simple-select",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},borderRadius:3,height:30},fullWidth:!0,value:r.pricing.priceQtyUnit,onChange:t=>u("pricing",t.target.value,"priceQtyUnit"),children:[e.jsx(J,{value:10,children:"kg"}),e.jsx(J,{value:20,children:"gram"})]})})})]})]})})]})]}),e.jsxs(s,{item:!0,xs:12,mt:3,children:[e.jsx(n,{fontWeight:600,children:i("translation:AddProduct:supplyQuantity")}),e.jsx(s,{container:!0,spacing:2,children:e.jsx(s,{item:!0,xs:12,children:e.jsxs(F,{sx:{boxShadow:x==="supplyQty"?M:A},children:[e.jsx(n,{color:"primary",pl:2,children:"Quantity"}),e.jsx(P,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0}},placeholder:"0000",fullWidth:!0,type:"number",inputProps:{style:{fontWeight:"bold"}},value:r.supplyQty,onChange:t=>{const a=Math.max(0,t.target.value);u("supplyQty",a)}})]})})})]}),e.jsxs(s,{item:!0,xs:12,mt:3,children:[e.jsx(n,{fontWeight:600,children:i("translation:AddProduct:orderQuantity")}),e.jsx(s,{container:!0,spacing:2,children:e.jsx(s,{item:!0,xs:12,children:e.jsxs(F,{sx:{boxShadow:A},children:[e.jsx(n,{color:"primary",pl:2,children:"Quantity"}),e.jsx(P,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0}},placeholder:"0000",fullWidth:!0,type:"number",inputProps:{style:{fontWeight:"bold"}},value:r.orderQty,onChange:t=>{const a=Math.max(0,t.target.value);u("orderQty",a)}})]})})})]}),e.jsxs(s,{item:!0,xs:12,mt:3,children:[e.jsx(n,{variant:"h6",fontWeight:700,mt:2,mb:2,children:i("translation:AddProduct:supplyFrequency")}),e.jsx(q,{sx:{mb:3}}),e.jsx(E,{fullWidth:!0,sx:{pl:2,pr:2},children:e.jsx(_,{"aria-labelledby":"demo-radio-buttons-group-label",value:r.supplyFrequency.toString(),onChange:t=>u("supplyFrequency",t.target.value==="true"),name:"radio-buttons-group",children:e.jsxs(s,{container:!0,children:[e.jsx(s,{item:!0,xs:9,children:e.jsx(n,{variant:"h5",children:i("translation:AddProduct:monthly")})}),e.jsx(s,{item:!0,xs:3,display:"flex",justifyContent:"end",mb:2,children:e.jsx(z,{value:"true",control:e.jsx(T,{}),labelPlacement:"start"})}),e.jsx(s,{item:!0,xs:9,children:e.jsx(n,{variant:"h5",children:i("translation:AddProduct:custom")})}),e.jsx(s,{item:!0,xs:3,display:"flex",justifyContent:"end",mb:2,children:e.jsx(z,{value:"false",control:e.jsx(T,{}),labelPlacement:"start"})})]})})}),!r.supplyFrequency&&e.jsxs(e.Fragment,{children:[e.jsx(n,{fontWeight:700,mt:2,mb:2,children:i("translation:AddProduct:monthRange")}),B()]}),e.jsx(q,{sx:{mt:3}})]}),e.jsxs(s,{item:!0,xs:12,mt:3,children:[e.jsx(n,{fontWeight:700,mt:2,mb:2,children:i("translation:AddProduct:otherDetails")}),e.jsx(n,{fontSize:"13px",mt:1,mb:1,children:i("translation:AddProduct:text2")}),e.jsx(P,{fullWidth:!0,InputProps:{sx:{borderRadius:3}},multiline:!0,rows:7,value:r.otherDetails,onChange:t=>u("otherDetails",t.target.value)})]}),e.jsxs(s,{item:!0,xs:12,children:[e.jsx(I,{variant:"contained",size:"large",fullWidth:!0,sx:{height:50,borderRadius:3,color:"white",mt:2},onClick:()=>o(),children:e.jsx(n,{textTransform:"capitalize",variant:"h6",children:"Save Product"})}),e.jsx(I,{size:"large",fullWidth:!0,sx:{height:50,borderRadius:3,color:"grey",mt:2},variant:"outlined",color:"secondary",onClick:()=>c(),children:e.jsx(n,{textTransform:"capitalize",variant:"h6",children:"Discard"})})]})]})})},Ve=()=>{const d=h.useRef(null),l=h.useRef(null),i=Z(),{t:y,i18n:W}=re(),[w,j]=h.useState(!1),[r,f]=h.useState(!1),x=L("(max-width:768px)"),m=L("(min-width:769px)"),b=S.getState().form.formData.productDetails,C=S.getState().form.productCategoryNames,[O,N]=h.useState(0),Q=o=>c=>{c.type==="keydown"&&(c.key==="Tab"||c.key==="Shift")||j(o)},k=e.jsx(e.Fragment,{children:e.jsx(he,{closeDrawer:()=>j(!1)})}),u=o=>{i(V(o)),j(!0)},U=()=>{const o=[...b];o.splice(O,1),i(ee(o)),R()};h.useEffect(()=>{w&&d.current&&(d.current.scrollTop=d.current.scrollHeight),w&&l.current&&(l.current.scrollTop=l.current.scrollHeight)},[w]);const B=o=>{N(o),f(!0)},R=()=>{f(!1)};return e.jsxs("div",{children:[e.jsx(n,{variant:"h4",fontWeight:700,mt:2,mb:2,children:y("translation:ProductDetails:heading")}),e.jsx(q,{sx:{mb:3}}),e.jsx(v,{display:"flex",flexDirection:"column",children:b.map((o,c)=>e.jsx(v,{sx:{boxShadow:"1px 5px 8px 5px rgba(0, 0, 0, 0.05)",borderRadius:3,mt:2,p:3,bgcolor:"#FFFFFF"},children:e.jsxs(s,{container:!0,children:[e.jsxs(s,{item:!0,xs:7,children:[e.jsx(n,{fontWeight:600,variant:"h6",children:o.name}),o.productOrRaw?e.jsx(e.Fragment,{children:e.jsxs(n,{children:[W.language=="en"?C[c].category.nameEnglish:W.language=="si"?C[c].category.nameSinhala:C[c].category.nameTamil," - ",W.language=="en"?C[c].subCategory.nameEnglish:W.language=="si"?C[c].subCategory.nameSinhala:C[c].subCategory.nameTamil]})}):e.jsx(e.Fragment,{children:e.jsx(n,{children:y("translation:AddProduct:rawMaterial")})})]}),e.jsxs(s,{item:!0,xs:5,display:"flex",justifyContent:"end",alignItems:"center",gap:3,children:[e.jsx(Y,{size:"small",onClick:()=>B(c),children:e.jsx(ie,{fontSize:"medium"})}),e.jsx(Y,{size:"small",onClick:()=>u(c),children:e.jsx(oe,{fontSize:"small"})})]}),e.jsx(s,{item:!0,xs:12,children:e.jsx(n,{mt:2,children:o.pricing.priceQtyUnitValue+(o.pricing.priceQtyUnit==10?"Kg":"gram")+" at Rs."+o.pricing.price+" can supply "+o.supplyQty+" units monthly."})})]})},c))}),!b.length>0&&e.jsx(e.Fragment,{children:e.jsx(n,{textAlign:"center",children:y("translation:ProductDetails:clickText")})}),e.jsxs(v,{display:"flex",justifyContent:"center",mt:2,children:[e.jsx(I,{variant:"contained",size:"medium",sx:{borderRadius:2,color:"white",ml:x?2:0},onClick:Q(!0),children:e.jsx(n,{textTransform:"capitalize",variant:"b1",children:!b.length>0?"Add Product":"Add Another Product"})}),x&&e.jsx(le,{anchor:"bottom",open:w,onClose:Q(!1),slotProps:{backdrop:{sx:{background:"rgba(0,0,0,0.4)"}}},children:e.jsx("div",{ref:l,style:{overflowY:"auto",height:"100%"},children:k})}),m&&e.jsx(K,{open:w,onClose:()=>j(!1),"aria-labelledby":"add-product-modal",fullWidth:!0,maxWidth:"md",slotProps:{backdrop:{sx:{background:"rgba(0,0,0,0.5)"}}},children:e.jsx(X,{ref:d,children:e.jsx(v,{sx:{bgcolor:"#F9FAFB",borderRadius:4,p:4},children:k})})})]}),e.jsxs(K,{open:r,onClose:()=>R(),"aria-labelledby":"add-product-modal",maxWidth:"xs",slotProps:{backdrop:{sx:{background:"rgba(0,0,0,0.7)"}}},children:[e.jsx(ce,{children:"Are you sure to delete? "}),e.jsx(X,{ref:d,children:e.jsxs(v,{display:"flex",justifyContent:"space-between",pt:2,pl:2,pr:2,children:[e.jsx(I,{variant:"contained",color:"secondary",size:"small",onClick:()=>R(),children:"No"}),e.jsx(I,{size:"small",variant:"contained",onClick:()=>U(),children:"Yes"})]})})]})]})};export{Ve as default};
