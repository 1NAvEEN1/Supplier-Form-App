import{r as c,j as e}from"./react-G0VBmWxS.js";import{u as Z,a as H}from"./react-redux-3PpUptFA.js";import{a as P,d as ee,e as ie,f as _,g as I}from"./index-jo0I7i86.js";import{a as te}from"./axios-zw96FDk0.js";import{u as re,T as le}from"./react-i18next-Ld4qvRaQ.js";import{B as v,G as n,T as a,D as B,R as J,j as E,k as q,i as N,A as K,m as S,n as de,o as D,b as T,u as U,I as Y,p as ce,q as ue,t as pe,v as V,w as X,x as he}from"./@mui-lgJpmoNL.js";import"./@babel-SkaEL2tl.js";import"./use-sync-external-store-BBrSSgse.js";import"./react-dom-wkoTY-Le.js";import"./scheduler-iwWdm5Ml.js";import"./react-router-dom-8rnrgVg8.js";import"./react-router-mRKdHBLr.js";import"./@remix-run-EOO7uaRF.js";import"./@reduxjs-OWLxucYK.js";import"./redux-vWdE9iQ8.js";import"./immer-2VFgZgpn.js";import"./reselect-knrTZChY.js";import"./redux-thunk-qyK_zz9Y.js";import"./prop-types-nTg9hSou.js";import"./i18next-NCffezqA.js";import"./i18next-http-backend-6HvsPMKJ.js";import"./cross-fetch-xd-Enngl.js";import"./clsx-2Jv0kmJG.js";import"./react-transition-group-NM3J4weW.js";import"./@emotion-cuKUoGzU.js";import"./hoist-non-react-statics-MGeNrgoW.js";import"./react-is-cHOZVpRJ.js";import"./stylis-UTZzoVRx.js";import"./@popperjs-zyV4rJhQ.js";import"./html-parse-stringify-gNhRsLCw.js";import"./void-elements-KNW2nDh4.js";const xe=async()=>{const u="/Product/GetProductCategories";return te.get(`https://supplierapi.cehub.lk/api${u}`).catch(d=>{console.log(d)})},me=async u=>{const d=`/Product/GetProductSubCategories/${u}`;return te.get(`https://supplierapi.cehub.lk/api${d}`).catch(i=>{console.log(i)})},A="1px 5px 8px 5px rgba(0, 0, 0, 0.05)",F="-1px 1px 8px 5px rgba(255, 0, 0, 0.3)",M=({children:u,sx:d={},...i})=>e.jsx(v,{sx:{borderRadius:3,mt:3,pt:1,pr:0,pb:1,...d},...i,children:u}),ge=({closeDrawer:u})=>{const d=Z(),{t:i,i18n:y}=re(),j=H(t=>t.form.formData),w=H(t=>t.form.productCategoryNames),f={productOrRaw:!0,productCategoryId:0,productSubCategoryId:0,name:"",description:"",price:"",supplyQuantity:"",unitType:0,monthlySupplyQuantity:"",monthlyMinimumQuantity:"",supplyMonths:[],otherDetails:"",supplyFrequency:!0},[r,b]=c.useState(f),[x,m]=c.useState(""),[C,p]=c.useState([]),[W,k]=c.useState([]),[z,O]=c.useState(!1),[G,Q]=c.useState(!1),L=async()=>{try{O(!0);const t=await xe();p(t.data)}catch(t){console.error("Error fetching Categories:",t)}finally{O(!1)}};c.useEffect(()=>{L()},[]);const R=async()=>{try{Q(!0);const t=await me(r.productCategoryId);k(t.data)}catch(t){console.error("Error fetching SubCategories:",t)}finally{Q(!1)}};c.useEffect(()=>{r.productCategoryId!==0&&R()},[r.productCategoryId]),c.useEffect(()=>{var o;const t=P.getState().form.selectedProductIndex;t!==99&&b((o=P.getState().form.formData)==null?void 0:o.productDetails[t])},[P.getState().form.selectedProductIndex]);const s=(t,o,h=null)=>{m(""),b(h?g=>({...g,[t]:{...g[t],[h]:o}}):g=>({...g,[t]:o,...t==="productCategoryId"&&{productSubCategoryId:0}}))},l=t=>{const h=r.supplyMonths.includes(t)?r.supplyMonths.filter(g=>g!==t):[...r.supplyMonths,t];s("supplyMonths",h)},se=()=>{const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return e.jsx(n,{container:!0,spacing:2,children:t.map((o,h)=>e.jsx(n,{item:!0,xs:3,display:"flex",justifyContent:"center",children:e.jsx(v,{bgcolor:r.supplyMonths.includes(o)?"#F47621":"#D5D8DC",onClick:()=>l(o),sx:{borderRadius:2,width:60,height:40,"&:hover":{cursor:"pointer",border:"2px solid #F47621"}},display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(a,{textAlign:"center",children:o})})},h))})},ne=()=>r.productCategoryId==0?(I({message:"Please select a product category !",type:"error"}),m("category"),0):r.productOrRaw&&r.productSubCategoryId==0?(I({message:"Please select a product subcategory !",type:"error"}),m("subCategory"),0):r.name==""?(I({message:"Please enter the product name !",type:"error"}),m("name"),0):r.price==""?(I({message:"Please enter the product price !",type:"error"}),m("price"),0):r.supplyQuantity==""?(I({message:"Please enter the price unit quantity!",type:"error"}),m("unit"),0):r.monthlySupplyQuantity==""?(I({message:"Please enter the monthly supply quantity !",type:"error"}),m("supplyQty"),0):!r.supplyFrequency&&r.supplyMonths.length==0?(I({message:"Please select the month range !",type:"error"}),0):1,ae=()=>{if(console.log(r),ne()){const o=[...j.productDetails],h=[...w],g={category:C.find($=>$.id===r.productCategoryId),subCategory:W.find($=>$.id===r.productSubCategoryId)};P.getState().form.selectedProductIndex!==99?(o[P.getState().form.selectedProductIndex]=r,h[P.getState().form.selectedProductIndex]=g):(o.push(r),h.push(g)),d(ee(o)),d(ie(h)),b(f),d(_(99)),u()}},oe=()=>{b(f),d(_(99)),u()};return e.jsx(v,{sx:{display:"flex",justifyContent:"center",bgcolor:"#F9FAFB"},children:e.jsxs(n,{container:!0,sx:{minHeight:"90svh",p:2,width:500,borderRadius:4},children:[e.jsxs(n,{item:!0,xs:12,children:[e.jsx(a,{textAlign:"center",fontWeight:600,mb:2,children:i("translation:AddProduct:heading")}),e.jsx(B,{style:{width:"100%",marginBottom:25}}),e.jsx(J,{"aria-labelledby":"demo-radio-buttons-group-label",value:r.productOrRaw.toString(),onChange:t=>(s("productOrRaw",t.target.value==="true"),t.target.value==="false"&&s("productSubCategoryId",0)),name:"radio-buttons-group",children:e.jsxs(n,{container:!0,children:[e.jsx(n,{item:!0,xs:6,children:e.jsx(a,{variant:"h5",children:i("translation:AddProduct:product")})}),e.jsx(n,{item:!0,xs:6,display:"flex",justifyContent:"end",mb:2,children:e.jsx(E,{value:"true",control:e.jsx(q,{}),labelPlacement:"start"})}),e.jsx(n,{item:!0,xs:6,children:e.jsx(a,{variant:"h5",children:i("translation:AddProduct:rawMaterial")})}),e.jsx(n,{item:!0,xs:6,display:"flex",justifyContent:"end",mb:2,children:e.jsx(E,{value:"false",control:e.jsx(q,{}),labelPlacement:"start"})})]})}),e.jsxs(M,{sx:{boxShadow:x==="category"?F:A},children:[e.jsx(a,{variant:"b1",fontWeight:500,color:"primary",pl:2,children:i("translation:AddProduct:category")}),e.jsx(N,{fullWidth:!0,children:e.jsx(K,{value:C.find(t=>t.id===r.productCategoryId)||null,size:"small",options:C,getOptionLabel:t=>y.language==="en"?t.nameEnglish:y.language==="si"?t.nameSinhala:t.nameTamil,onChange:(t,o)=>{s("productCategoryId",o?o.id:0),k([])},renderInput:t=>e.jsx(S,{...t,placeholder:i("translation:AddProduct:selectCategory"),sx:{".MuiOutlinedInput-notchedOutline":{border:0},borderRadius:3,height:40}}),loading:z})})]}),r.productOrRaw&&e.jsx(e.Fragment,{children:e.jsxs(M,{sx:{boxShadow:x==="subCategory"?F:A},children:[e.jsx(a,{variant:"b1",fontWeight:500,color:"primary",pl:2,children:i("translation:AddProduct:subCategory")}),e.jsx(N,{fullWidth:!0,children:e.jsx(K,{value:W.find(t=>t.id===r.productSubCategoryId)||null,size:"small",options:W,getOptionLabel:t=>y.language==="en"?t.nameEnglish:y.language==="si"?t.nameSinhala:t.nameTamil,onChange:(t,o)=>{s("productSubCategoryId",o?o.id:0)},renderInput:t=>e.jsx(S,{...t,placeholder:i("translation:AddProduct:selectSubCategory"),sx:{".MuiOutlinedInput-notchedOutline":{border:0},borderRadius:3,height:40}}),disabled:r.productCategoryId===0,loading:G})})]})}),e.jsxs(M,{sx:{boxShadow:x==="name"?F:A},children:[e.jsx(a,{color:"primary",pl:2,children:i("translation:AddProduct:name")}),e.jsx(S,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0}},placeholder:i("translation:AddProduct:productName"),fullWidth:!0,value:r.name,onChange:t=>s("name",t.target.value)})]})]}),e.jsxs(n,{item:!0,xs:12,mt:3,children:[e.jsx(a,{fontWeight:600,children:i("translation:AddProduct:pricing")}),e.jsx(a,{fontSize:"13px",mt:1,children:e.jsxs(le,{i18nKey:"AddProduct.text1",children:["Please select the units of quantity when adding price. ",e.jsx("br",{}),"(For example: per kg, per liter, per gram, per one piece, etc.)"]})}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,children:e.jsxs(M,{sx:{boxShadow:x==="price"?F:A},children:[e.jsx(a,{color:"primary",pl:2,children:"Price (Rupees)"}),e.jsx(S,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},pl:2,pr:2},placeholder:"0000",fullWidth:!0,type:"number",inputProps:{style:{fontWeight:"bold"}},value:r.price,onChange:t=>{const o=Math.max(0,t.target.value);s("price",o)}})]})}),e.jsx(n,{item:!0,xs:12,mt:-2,children:e.jsxs(M,{height:85,sx:{boxShadow:x==="unit"?F:A},children:[e.jsx(a,{color:"primary",pl:2,mb:0,children:"Quantity unit"}),e.jsxs(n,{container:!0,children:[e.jsx(n,{item:!0,xs:5,mb:3,children:e.jsx(S,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},pl:2},placeholder:"00",fullWidth:!0,type:"number",inputProps:{style:{fontWeight:"bold"}},value:r.supplyQuantity,onChange:t=>{const o=Math.max(0,t.target.value);s("supplyQuantity",o)}})}),e.jsx(n,{item:!0,xs:7,mt:.5,children:e.jsx(N,{fullWidth:!0,children:e.jsxs(de,{id:"demo-simple-select",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},borderRadius:3,height:30,textAlign:"center",pl:2},fullWidth:!0,value:r.unitType,onChange:t=>s("unitType",t.target.value),children:[e.jsx(D,{value:0,children:"Kilogram (kg)"}),e.jsx(D,{value:1,children:"Gram (g)"}),e.jsx(D,{value:2,children:"Milligram (mg)"}),e.jsx(D,{value:3,children:"Milliliter (ml)"}),e.jsx(D,{value:4,children:"Liter (l)"}),e.jsx(D,{value:5,children:"Packet"}),e.jsx(D,{value:6,children:"Unit"})]})})})]})]})})]})]}),e.jsxs(n,{item:!0,xs:12,mt:3,children:[e.jsx(a,{fontWeight:600,children:i("translation:AddProduct:supplyQuantity")}),e.jsx(n,{container:!0,spacing:2,children:e.jsx(n,{item:!0,xs:12,children:e.jsxs(M,{sx:{boxShadow:x==="supplyQty"?F:A},children:[e.jsx(a,{color:"primary",pl:2,children:"Quantity"}),e.jsx(S,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},pl:2,pr:2},placeholder:"0000",fullWidth:!0,type:"number",inputProps:{style:{fontWeight:"bold"}},value:r.monthlySupplyQuantity,onChange:t=>{const o=Math.max(0,t.target.value);s("monthlySupplyQuantity",o)}})]})})})]}),e.jsxs(n,{item:!0,xs:12,mt:3,children:[e.jsx(a,{fontWeight:600,children:i("translation:AddProduct:orderQuantity")}),e.jsx(n,{container:!0,spacing:2,children:e.jsx(n,{item:!0,xs:12,children:e.jsxs(M,{sx:{boxShadow:A},children:[e.jsx(a,{color:"primary",pl:2,children:"Quantity"}),e.jsx(S,{size:"small",sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},pl:2,pr:2},placeholder:"0000",fullWidth:!0,type:"number",inputProps:{style:{fontWeight:"bold"}},value:r.monthlyMinimumQuantity,onChange:t=>{const o=Math.max(0,t.target.value);s("monthlyMinimumQuantity",o)}})]})})})]}),e.jsxs(n,{item:!0,xs:12,mt:3,children:[e.jsx(a,{variant:"h6",fontWeight:700,mt:2,mb:2,children:i("translation:AddProduct:supplyFrequency")}),e.jsx(B,{sx:{mb:3}}),e.jsx(N,{fullWidth:!0,sx:{pl:2,pr:2},children:e.jsx(J,{"aria-labelledby":"demo-radio-buttons-group-label",value:r.supplyFrequency.toString(),onChange:t=>(s("supplyFrequency",t.target.value==="true"),t.target.value==="true"&&s("supplyMonths",[])),name:"radio-buttons-group",children:e.jsxs(n,{container:!0,children:[e.jsx(n,{item:!0,xs:9,children:e.jsx(a,{variant:"h5",children:i("translation:AddProduct:monthly")})}),e.jsx(n,{item:!0,xs:3,display:"flex",justifyContent:"end",mb:2,children:e.jsx(E,{value:"true",control:e.jsx(q,{}),labelPlacement:"start"})}),e.jsx(n,{item:!0,xs:9,children:e.jsx(a,{variant:"h5",children:i("translation:AddProduct:custom")})}),e.jsx(n,{item:!0,xs:3,display:"flex",justifyContent:"end",mb:2,children:e.jsx(E,{value:"false",control:e.jsx(q,{}),labelPlacement:"start"})})]})})}),!r.supplyFrequency&&e.jsxs(e.Fragment,{children:[e.jsx(a,{fontWeight:700,mt:2,mb:2,children:i("translation:AddProduct:monthRange")}),se()]}),e.jsx(B,{sx:{mt:3}})]}),e.jsxs(n,{item:!0,xs:12,mt:3,children:[e.jsx(a,{fontWeight:700,mt:2,mb:2,children:i("translation:AddProduct:otherDetails")}),e.jsx(a,{fontSize:"13px",mt:1,mb:1,children:i("translation:AddProduct:text2")}),e.jsx(S,{fullWidth:!0,InputProps:{sx:{borderRadius:3}},multiline:!0,rows:7,value:r.otherDetails,onChange:t=>s("otherDetails",t.target.value)})]}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx(T,{variant:"contained",size:"large",fullWidth:!0,sx:{height:50,borderRadius:3,color:"white",mt:2},onClick:()=>ae(),children:e.jsx(a,{textTransform:"capitalize",variant:"h6",children:"Save Product"})}),e.jsx(T,{size:"large",fullWidth:!0,sx:{height:50,borderRadius:3,color:"grey",mt:2},variant:"outlined",color:"secondary",onClick:()=>oe(),children:e.jsx(a,{textTransform:"capitalize",variant:"h6",children:"Discard"})})]})]})})},Ke=()=>{const u=c.useRef(null),d=c.useRef(null),i=Z(),{t:y,i18n:j}=re(),[w,f]=c.useState(!1),[r,b]=c.useState(!1),x=U("(max-width:768px)"),m=U("(min-width:769px)"),C=P.getState().form.formData.productDetails,p=P.getState().form.productCategoryNames,[W,k]=c.useState(0),z=s=>l=>{l.type==="keydown"&&(l.key==="Tab"||l.key==="Shift")||f(s)},O=e.jsx(e.Fragment,{children:e.jsx(ge,{closeDrawer:()=>f(!1)})}),G=s=>{i(_(s)),f(!0)},Q=()=>{const s=[...C];s.splice(W,1),i(ee(s)),R()};c.useEffect(()=>{w&&u.current&&(u.current.scrollTop=u.current.scrollHeight),w&&d.current&&(d.current.scrollTop=d.current.scrollHeight)},[w]);const L=s=>{k(s),b(!0)},R=()=>{b(!1)};return e.jsxs("div",{children:[e.jsx(a,{variant:"h4",fontWeight:700,mt:2,mb:2,children:y("translation:ProductDetails:heading")}),e.jsx(B,{sx:{mb:3}}),e.jsx(v,{display:"flex",flexDirection:"column",children:C.map((s,l)=>e.jsx(v,{sx:{boxShadow:"1px 5px 8px 5px rgba(0, 0, 0, 0.05)",borderRadius:3,mt:2,p:3,bgcolor:"#FFFFFF"},children:e.jsxs(n,{container:!0,children:[e.jsxs(n,{item:!0,xs:9,children:[e.jsx(a,{fontWeight:600,variant:"h6",children:s.name}),s.productOrRaw?e.jsx(e.Fragment,{children:e.jsxs(a,{children:[j.language=="en"?p[l].category.nameEnglish:j.language=="si"?p[l].category.nameSinhala:p[l].category.nameTamil," - ",j.language=="en"?p[l].subCategory.nameEnglish:j.language=="si"?p[l].subCategory.nameSinhala:p[l].subCategory.nameTamil]})}):e.jsx(e.Fragment,{children:e.jsxs(a,{children:[j.language=="en"?p[l].category.nameEnglish:j.language=="si"?p[l].category.nameSinhala:p[l].category.nameTamil," - ",y("translation:AddProduct:rawMaterial")]})})]}),e.jsxs(n,{item:!0,xs:3,display:"flex",justifyContent:"end",alignItems:"center",gap:3,children:[e.jsx(Y,{size:"small",onClick:()=>L(l),children:e.jsx(ce,{fontSize:"medium"})}),e.jsx(Y,{size:"small",onClick:()=>G(l),children:e.jsx(ue,{fontSize:"small"})})]}),e.jsx(n,{item:!0,xs:12,children:e.jsx(a,{mt:2,children:s.supplyQuantity+(s.unitType==0?"Kg":s.unitType==1?"g":s.unitType==2?"mg":s.unitType==3?"l":s.unitType==4?"ml":s.unitType==5?" packets":" Unit")+" at Rs."+s.price+" can supply "+s.monthlySupplyQuantity+" units monthly."})})]})},l))}),!C.length>0&&e.jsx(e.Fragment,{children:e.jsx(a,{textAlign:"center",children:y("translation:ProductDetails:clickText")})}),e.jsxs(v,{display:"flex",justifyContent:"center",mt:2,children:[e.jsx(T,{variant:"contained",size:"medium",sx:{borderRadius:2,color:"white",ml:x?2:0},onClick:z(!0),children:e.jsx(a,{textTransform:"capitalize",variant:"b1",children:!C.length>0?"Add Product":"Add Another Product"})}),x&&e.jsx(pe,{anchor:"bottom",open:w,onClose:z(!1),slotProps:{backdrop:{sx:{background:"rgba(0,0,0,0.4)"}}},children:e.jsx("div",{ref:d,style:{overflowY:"auto",height:"100%"},children:O})}),m&&e.jsx(V,{open:w,onClose:()=>f(!1),"aria-labelledby":"add-product-modal",fullWidth:!0,maxWidth:"md",slotProps:{backdrop:{sx:{background:"rgba(0,0,0,0.5)"}}},children:e.jsx(X,{ref:u,children:e.jsx(v,{sx:{bgcolor:"#F9FAFB",borderRadius:4,p:4},children:O})})})]}),e.jsxs(V,{open:r,onClose:()=>R(),"aria-labelledby":"add-product-modal",maxWidth:"xs",slotProps:{backdrop:{sx:{background:"rgba(0,0,0,0.7)"}}},children:[e.jsx(he,{children:"Are you sure to delete? "}),e.jsx(X,{ref:u,children:e.jsxs(v,{display:"flex",justifyContent:"space-between",pt:2,pl:2,pr:2,children:[e.jsx(T,{variant:"contained",color:"secondary",size:"small",onClick:()=>R(),children:"No"}),e.jsx(T,{size:"small",variant:"contained",onClick:()=>Q(),children:"Yes"})]})})]})]})};export{Ke as default};
